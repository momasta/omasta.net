{{/* https://www.codeproject.com/Articles/5276331/Creating-an-Image-Gallery-with-Hugo-and-Lightbox2 */}}

{{/* Optional parameter to specify an asset subdirectory */}}
{{- $param0 := default "" (.Get 0) -}}
{{- $directory := cond (ne "" $param0) (print "/" $param0) "" -}}
{{- $path := (print "images" $directory "/*.{jpg,JPG,jpeg,JPEG,png,PNG,gif,GIF}") -}}

<div class="gallery">
	{{- $image := (resources.Match $path) -}}

	<div id="gallery-filter">
		<form action="#" id="gallery-filter-form">
			<input type="search" placeholder="Filterâ€¦" id="gallery-filter-input"
				   autocomplete="off" autocapitalize="off" autofocus>
			<input type="submit" value="Filter" tabindex="-1" id="gallery-filter-submit">
		</form>
	</div>
	
	{{ with $image }}
	    {{ range . }} 
	    	{{ $imageName := (.Name | replaceRE "^.*/(.*)\\..*" "$1") | safeHTMLAttr }} 
	    	
	    	<a href="{{ .Permalink }}" class="gallery-image state-visible" data-lightbox="x"
	    	   data-title="{{ $imageName }}" data-alt="{{ $imageName }}">
	 
	 			{{/* todo Make this condition inline if possible */}}
				{{ if (eq .MediaType.SubType "gif") }}
			    	<img src="{{ .Permalink }}" class="gallery-image-thumb" loading="lazy"
			    		alt="{{ $imageName }}" />
		    	{{ else }}
		    		{{ $thumb := .Fill "288x288 q75" }}
			    	<img src="{{ $thumb.Permalink }}" class="gallery-image-thumb" loading="lazy"
		    			 alt="{{ $imageName }}" />
		    	{{ end }}
      		</a>
	    {{ end }}
	{{ end }}
</div>

<link rel="stylesheet" href="/css/lightbox.min.css">
<script src="/js/jquery-3.6.1.min.js"></script>
<script src="/js/lightbox.min.js"></script>
<script src="{{ print "/js/lightbox-options.js?" now.Unix }}"></script>
<script src="{{ print "/js/gallery_filter.js?" now.Unix }}"></script>
